### This file is for LOCAL development purposes ONLY ###
version: '3.7'
services:
  din-caddy:
    image: din-caddy
    container_name: din-caddy
    restart: always
    ports:
      - 2019:2019
      - 8000:8000
    volumes:
      - ./Caddyfile.private:/etc/caddy/Caddyfile
    environment:
      - OTEL_SERVICE_NAME=test-service3
      - OTEL_EXPORTER_OTLP_ENDPOINT=http://tempo-prod-04-prod-us-east-0.grafana.net:443
      - OTEL_RESOURCE_ATTRIBUTES=deployment.environment=production,service.instance.id=shopping-cart-66b6c48dd5-hprdn
      - OTEL_EXPORTER_OTLP_TRACES_ENDPOINT=http://tempo-prod-04-prod-us-east-0.grafana.net:443
      - OTEL_EXPORTER_OTLP_INSECURE=true
      - OTEL_EXPORTER_OTLP_PROTOCOL=grpc
  otel-collector:
    container_name: otel-collector
    image: otel/opentelemetry-collector-contrib:0.99.0
    volumes:
      - ./services/otel-collector/config.yml:/etc/otel/config/config.yml
    ports:
      - 4317:4317
      - 8888:8888 # for Prometheus metrics /metrics
    command: ["--config=/etc/otel/config/config.yml"]